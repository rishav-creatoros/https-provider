"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.hashClaimInfo = exports.createSignDataForClaim = exports.createSignDataForCommunicationKey = void 0;
var ethers_1 = require("ethers");
function createSignDataForCommunicationKey(_a) {
    var communicationPublicKey = _a.communicationPublicKey, linkId = _a.linkId, context = _a.context;
    var str = "".concat(ethers_1.utils.hexlify(communicationPublicKey).toLowerCase(), "\n").concat(linkId, "\n").concat(context !== null && context !== void 0 ? context : '');
    return Buffer.from(str, 'utf-8');
}
exports.createSignDataForCommunicationKey = createSignDataForCommunicationKey;
function createSignDataForClaim(data) {
    var info = 'infoHash' in data ? data.infoHash : hashClaimInfo(data);
    return [
        info,
        data.owner.toLowerCase(),
        data.timestampS.toString(),
        data.claimId.toString(),
    ].join('\n');
}
exports.createSignDataForClaim = createSignDataForClaim;
function hashClaimInfo(info) {
    var str = "".concat(info.provider, "\n").concat(info.parameters, "\n").concat(info.context || '');
    return ethers_1.utils.keccak256(Buffer.from(str, 'utf-8')).toLowerCase();
}
exports.hashClaimInfo = hashClaimInfo;
//# sourceMappingURL=sign-data.js.map